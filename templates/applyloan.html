{% extends 'base.html' %}
{% load static %}
{% block body_block %}

<div class="container mt-5">
   <div class="card">
    <form id="multiTabForm ">
        <!-- Tabs Navigation -->
        <ul class="nav nav-tabs mt-3" id="formTabs" role="tablist">
            <li class="nav-item">
                <button class="nav-link active" id="tab1-tab" data-bs-toggle="tab" data-bs-target="#tab1" type="button" role="tab">Loan Product</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="tab2-tab" data-bs-toggle="tab" data-bs-target="#tab2" type="button" role="tab">Repayment Schedule</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="tab3-tab" data-bs-toggle="tab" data-bs-target="#tab3" type="button" role="tab">Payment Details</button>
            </li>
            <li class="nav-item">
                <button class="nav-link" id="tab4-tab" data-bs-toggle="tab" data-bs-target="#tab4" type="button" role="tab">Loan Guarantors</button>
            </li>
           
            <li class="nav-item">
                <button class="nav-link" id="tab6-tab" data-bs-toggle="tab" data-bs-target="#tab6" type="button" role="tab">Review & Submit</button>
            </li>
        </ul>

        <!-- Tabs Content -->
        <div class="tab-content">
            <!-- Tab 1 -->
            <div class="tab-pane fade show active mx-2 my-2" id="tab1" role="tabpanel">
                <h5 class="mt-4 mb-3">Loan Details </h5>
                <!-- Application ID -->
                 <div class="row mb-2 ">
  {% comment %} <div class="col-md-4">
    <label for="application_id">Application ID</label>
    <input type="text" id="application_id" name="application_id" maxlength="20" class="form-control" required>
  </div> {% endcomment %}

  <!-- Member -->
  {% comment %} <div class="col-md-4">
    <label for="member_id">Member</label>
    <select id="member_id" name="member_id" class="form-control" required>
      <!-- Dynamically populate choices -->
    </select>
  </div> {% endcomment %}

  <!-- Loan Type -->
  <div class="col-md-4">
    <label for="loantype">Loan Type</label>
    <select id="loantype" name="loantype" class="form-control" required>
        <option value="" disabled selected>Select Loan Type</option>
        {% for loan in loan_types %}
            <option value="{{ loan.code }}" >{{ loan.loantype }}</option>
        {% endfor %}
    </select>
</div>
</div>
<div class="row mb-2">
  <!-- Collateral -->
  {% comment %} <div class="col-md-4">
    <label for="collateral">Collateral</label>
    <select id="collateral" name="collateral" class="form-control">
      <!-- Dynamically populate choices -->
    </select>
  </div> {% endcomment %}

  <!-- Loan Amount -->
  <div class="col-md-4">
    <label for="loan_amount">Loan Amount</label>
    <input type="number" id="loan_amount" name="loan_amount" class="form-control" required>
  </div>

  <!-- Disbursement Type -->
  <div class="col-md-4">
    <label for="disbursement_type">Disbursement Type</label>
    <select id="disbursement_type" name="disbursement_type" class="form-control" required>
      <option value="one_off">One-off</option>
      <option value="trenches">Trenches</option>
    </select>
  </div>
</div>
<div class="row mb-2">

  <!-- Interest Rate -->
  <div class="col-md-4">
    <label for="interest_rate">Interest Rate</label>
    <input type="number" id="interest_rate" name="interest_rate" class="form-control" required>
  </div>

  <!-- Tenure -->
  <div class="col-md-4">
    <label for="tenure">Tenure</label>
    <input type="number" id="tenure" name="tenure" class="form-control" required>
  </div>

  <!-- Tenure Type -->
  <div class="col-md-4">
    <label for="tenure_type">Tenure Type</label>
    <select id="tenure_type" name="tenure_type" class="form-control" required>
      <option value="days">Days</option>
      <option value="weeks">Weeks</option>
      <option value="months">Months</option>
      <option value="years">Years</option>
    </select>
  </div></div>
<div class="row mb-2">
  <!-- Repayment Start Date -->
  <div class="col-md-4">
    <label for="repayment_start_date">Repayment Start Date</label>
    <input type="date" id="repayment_start_date" name="repayment_start_date" class="form-control" required>
  </div>

  <!-- Loan Calculation Method -->
  <div class="col-md-4">
    <label for="loan_calculation_method">Loan Calculation Method</label>
    <input type="text" id="loan_calculation_method" name="loan_calculation_method" class="form-control"  required>
  </div>

  <!-- Repayment Schedule -->
  <div class="col-md-4">
    <label for="repayment_schedule">Repayment Schedule</label>
    <select id="repayment_schedule" name="repayment_schedule" class="form-control" required>
      <option value="daily">Daily</option>
      <option value="weekly">Weekly</option>
      <option value="monthly">Monthly</option>
      <option value="quarterly">Quarterly</option>
      <option value="halfyearly">Half-yearly</option>
      <option value="annually">Annually</option>
      <option value="one_time">One-time</option>
    </select>
  </div>
</div>
<div class="row mb-2">
  <!-- Repayment Mode -->
  <div class="col-md-4">
    <label for="repayment_mode">Repayment Mode</label>
    <select id="repayment_mode" name="repayment_mode" class="form-control" required>
      <option value="principal_only">Principal Only</option>
      <option value="interest_only">Interest Only</option>
      <option value="both">Both</option>
      <option value="interest_first">Interest First</option>
      <option value="principal_end">Principal End</option>
    </select>
  </div>

  <!-- Interest Basics -->
  <div class="col-md-4">
    <label for="interest_basics">Interest Basics</label>
    <select id="interest_basics" name="interest_basics" class="form-control" required>
      <option value="365">365</option>
      <option value="other">Other</option>
    </select>
  </div>
  <!-- Is Active -->
  <div class="col-md-4">
    <label for="is_active">Is Active</label>
    <input type="checkbox" id="is_active" name="is_active">
  </div>
</div>
<div class="row mb-2">
  <!-- Loan Purpose -->
  <div class="col-md-6">
    <label for="loan_purpose">Loan Purpose</label>
    <textarea id="loan_purpose" name="loan_purpose" class="form-control" required></textarea>
  </div>

  <!-- Description -->
  <div class="col-md-6">
    <label for="description">Description</label>
    <textarea id="description" name="description" class="form-control" required></textarea>
  </div></div>

  

  
  <button type="button" class="btn btn-primary next">Next</button>
            </div>

            <!-- Tab 2 -->
            <div class="tab-pane fade px-3 py-3" id="tab2" role="tabpanel">
                <div class="mb-3">
                    <label for="field2" class="form-label">Field 2</label>
                    <input type="text" class="form-control" id="field2" name="field2" required>
                </div>
                <button type="button" class="btn btn-dark prev">Previous</button>
                <button type="button" class="btn btn-primary next">Next</button>
            </div>

            <!-- Tab 3 -->
            <div class="tab-pane fade px-3 py-3" id="tab3" role="tabpanel">
                <h5 class="mt-3 mb-3">Repayment Details</h5>
                <div class="row mb-2">
                <div class="col-md-4">
                    {{ form.principal_repayment.label_tag }}
                    {{ form.principal_repayment }}
                </div>
                <div class="col-md-4">
                    {{ form.interest_repayment.label_tag }}
                    {{ form.interest_repayment }}
                </div>
                <div class="col-md-4 mb-4">
                    {{ form.total_repayment.label_tag }}
                    {{ form.total_repayment }}
                </div></div>
                <button type="button" class="btn btn-dark prev">Previous</button>
                <button type="button" class="btn btn-primary next">Next</button>
            </div>

            <!-- Tab 4 -->
            <div class="tab-pane fade mx-2 my-2" id="tab4" role="tabpanel">
                <div class="container mt-5">
                    <div class="d-flex justify-content-between">
                  <h5>Member Table</h5>
                  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addDataModal">Add Data</button>
                </div>
                <div class="table-responsive">
                  <table class="table text-nowrap align-middle mb-0">
                    <thead>
                      <tr class="border-2 border-bottom border-primary border-0">
                        <th>#</th>
                        <th>Member No</th>
                        <th>ID No</th>
                        <th>Member</th>
                        <th>Amount</th>
                        <th>Status</th>
                        <th>Action</th>
                      </tr>
                    </thead>
                    <tbody id="table-body" class="table-group-divider">
                     <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                     </tr>
                    </tbody>
                  </table></div>
                </div>
              
                <!-- Modal -->
                <div class="modal fade" id="addDataModal" tabindex="-1" aria-labelledby="addDataModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="addDataModalLabel">Add Data</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <form id="dataForm">
                          <div class="mb-3">
                            <label for="idNo" class="form-label">ID No</label>
                            <input type="text" id="idNo" class="form-control" required>
                          </div>
                          <div class="mb-3">
                            <label for="amount" class="form-label">Amount to be Guaranteed</label>
                            <input type="number" id="amount" class="form-control" required>
                          </div>
                          <button type="submit" class="btn btn-success">Save</button>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              
                <button type="button" class="btn btn-dark prev">Previous</button>
                <button type="button" class="btn btn-primary next">Next</button>
              </div>
              
            

           

            <!-- Tab 6 -->
            <div class="tab-pane fade px-2 py-2" id="tab6" role="tabpanel">
                <div class="mb-3">
                    <label for="field6" class="form-label">Field 6</label>
                    <input type="text" class="form-control" id="field6" name="field6" required>
                </div>
                <button type="button" class="btn btn-dark prev">Previous</button>
                <button type="submit" class="btn btn-success">Submit</button>
              </div>
        </div>
    </form>
  </div>
    
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script>
    document.querySelectorAll('.next').forEach(button => {
        button.addEventListener('click', () => {
            const activeTab = document.querySelector('.nav-link.active');
            const nextTab = activeTab.closest('li').nextElementSibling?.querySelector('button');
            if (nextTab) nextTab.click();
        });
    });

    document.querySelectorAll('.prev').forEach(button => {
        button.addEventListener('click', () => {
            const activeTab = document.querySelector('.nav-link.active');
            const prevTab = activeTab.closest('li').previousElementSibling?.querySelector('button');
            if (prevTab) prevTab.click();
        });
    });

    document.getElementById('multiTabForm').addEventListener('submit', event => {
        event.preventDefault();
        const formData = new FormData(event.target);
        const formObject = Object.fromEntries(formData.entries());
        alert('Form Submitted: ' + JSON.stringify(formObject, null, 2));
    });
</script>
<script>
  // JavaScript to handle dropdown change
  document.getElementById('loantype').addEventListener('change', function () {
      // Get selected option
      const selectedOption = this.options[this.selectedIndex];

      // Get data attributes from the selected option
      const interestRate = selectedOption.getAttribute('data-interest-rate');
      const loanMethod = selectedOption.getAttribute('data-loan-method');

      // Update the form fields
      document.getElementById('interest_rate').value = interestRate || '';
      document.getElementById('loan_calculation_method').value = loanMethod || '';
  });
  document.getElementById("multiTabForm").addEventListener("submit", function(event) {
    event.preventDefault(); // Prevent the default form submission
    // Perform custom validation or submission logic here
    this.submit(); // Programmatically submit the form
});

  
</script>
{% endblock %}